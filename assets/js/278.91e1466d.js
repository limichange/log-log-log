(window.webpackJsonp=window.webpackJsonp||[]).push([[278],{622:function(t,a,r){"use strict";r.r(a);var s=r(43),e=Object(s.a)({},(function(){var t=this,a=t.$createElement,r=t._self._c||a;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"http-网络劫持与-dns-劫持原理及预防"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#http-网络劫持与-dns-劫持原理及预防"}},[t._v("#")]),t._v(" http 网络劫持与 DNS 劫持原理及预防")]),t._v(" "),r("h2",{attrs:{id:"网络劫持的原理"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#网络劫持的原理"}},[t._v("#")]),t._v(" 网络劫持的原理")]),t._v(" "),r("h3",{attrs:{id:"dns-劫持"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#dns-劫持"}},[t._v("#")]),t._v(" DNS 劫持")]),t._v(" "),r("p",[t._v("一般而言，用户上网的 DNS 服务器都是运营商分配的，所以在这个节点上，运营商可以为所欲为。\n例如，访问http://jiankang.qq.com/index.html，正常DNS应该返回腾讯的ip，而DNS劫持后，会返回一个运营商的中间服务器ip。访问该服务器会一致性的返回302，让用户浏览器跳转到预处理好的带广告的网页，在该网页中再通过iframe打开用户原来访问的地址。")]),t._v(" "),r("h3",{attrs:{id:"http-劫持"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#http-劫持"}},[t._v("#")]),t._v(" HTTP 劫持")]),t._v(" "),r("p",[t._v("在运营商的路由器节点上，设置协议检测，一旦发现是 HTTP 请求，而且是 html 类型请求，则拦截处理。\n常见有两种：")]),t._v(" "),r("p",[t._v("类似 DNS 劫持返回 302 让用户浏览器跳转到另外的地址。(钓鱼网站就是这么干)\n在服务器返回的 HTML 数据中插入 js 或 dom 节点（广告）。（比较常见）")]),t._v(" "),r("h2",{attrs:{id:"被劫持怎么办"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#被劫持怎么办"}},[t._v("#")]),t._v(" 被劫持怎么办?")]),t._v(" "),r("p",[t._v("对于用户来说，最最直接的就是向运营商投诉。\n在 html 上加上 ")]),r("meta",{attrs:{"http-equiv":"Cache-Control",content:"no-siteapp"}}),t._v(" "),r("meta",{attrs:{"http-equiv":"Cache-Control",content:"no-transform "}}),t._v(" 百度官方给的禁止转码声明。\n最有用的方式，使用 HTTPS ,不让数据那么明显的裸奔。 https 加了 SSL 协议，会对数据进行加密。\n在开发的网页中加入代码过滤，大概思路就是用 JavaScript 代码检查所有的外链是否属于白名单。"),r("p"),t._v(" "),r("h2",{attrs:{id:"js-实际对抗"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#js-实际对抗"}},[t._v("#")]),t._v(" js 实际对抗")]),t._v(" "),r("p",[t._v("在 window 监听 DOMNodeInserted 事件，上报插入的 dom、分析插入的 dom 信息。(通常匹配所有的 url,逐个比较是否白名单域名，如果不是，则判定为劫持，上报的同时，移除 dom.parentNode.removeChild(dom)); 刚插入的 dom。小心误伤。比较稳的操作是做监测统计，再决策预防。")]),t._v(" "),r("h2",{attrs:{id:"links"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#links"}},[t._v("#")]),t._v(" links")]),t._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://juejin.im/post/5cb00dec6fb9a0686a22404c",target:"_blank",rel:"noopener noreferrer"}},[t._v("http 网络劫持与 DNS 劫持原理及预防"),r("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=e.exports}}]);