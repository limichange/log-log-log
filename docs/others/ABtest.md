# 流量测试平台

<!-- ## 尝试设计一套 A/B Test 方案，来确定更新后交互设计得到了正向优化，包括但不限于：分桶方案；投放策略；配置后台；埋点

A/B 测试方案

分桶方案

分桶测试(bucket testing BTS)

投放策略

配置后台

埋点

A/B 测试的主要场景有两种：对比实验和灰度发布。 -->

## 平台模块

- 实验管理模块
- 行为记录模块
- 效果评估模块

![a](https://github.com/limichange/log-log-log/blob/master/docs/others/images/pic1.png?raw=true)

### 实验管理模块

流量分配规则：正交与互斥

互斥实验

实验分类
基于 Google 分层实验平台，结合实际需求进行了以下实验分类。

根据实验种类分类
水平实验：类似于 Overlapping Layer 中的实验，是属于同个“层”的实验，实验是互斥的，在同一“层”上实验可以理解为是同一种实验，例如：关键词“层”表示这一层的实验都是关键词相关的，该层上存在实验 H1 和 H2，那么流量绝对不会同时命中 H1 和 H2。

垂直实验：类似于 Non-overlapping Layer 中的实验，分布于不同“层”之间，实验是不互斥的，例如在关键词“层”和 CTR“层”上在相同的分桶上配置了实验 V1 和 V2，那么流量可以同时命中 V1 和 V2。

条件实验：表示进入某“层”的实验需要满足某些条件，水平实验和垂直实验都可以是条件实验。

根据流量类别分类
这种分类主要了为了用户体验，使平台在操作上更加的简单、易用：

普通实验：最基本的实验，根据流量类别进行配置。

引用实验：流量分类是整个配置中心基础，但实际上存在一些实验是跨流量了，而引用实验则可以配置在不同的流量种类中。

全局实验：可以理解为特殊的引用实验，全局实验在所有流量上都生效。

投放策略

分流引擎

分流策略：简单的理解就是哪些用户会命中策略 A，哪些用户会命中策略 B。

在说分流策略之前先举个例子，配合例子更好理解。

假设报名按钮颜色实验分 50%流量，策略“红色”按钮分流量 40%，策略“蓝色”按钮分流量 60%

例如：取模 10000，那报名按钮颜色实验的数字区间为 0-5000；10000\*50%。

策略“红色”按钮数字区间为 0-2000；5000\*40%。

策略“蓝色”按钮数字区间为 2000-5000；2000+5000\*60%。

现在我们对用户唯一 id，应用 id 进行哈希。哈希后得到一个数字，这个数字落到哪个数字区间就将用户分到哪个策略中去。经测试 10w 次分流，8s，流量 diff 在 1%以内，每个应用分到的用户正交，不相互影响。

### 业务接入模块

### 行为记录分析模块

### 效果评估模块

## links

- [AB 测试平台的工程实现](https://zhuanlan.zhihu.com/p/79961254)
- [糖豆 A/B 测试实验平台](https://www.jianshu.com/p/2fcdd25d3499)
